import{z as S,r as i,u as H,j as N,k as P,A as $,g as A,B as R,c as p,a as t,d as D,b as I,t as n,s as h,e as T,y as K,n as L,o as m}from"./index-gf5CXO_P.js";const U={class:"min-h-screen bg-black flex items-center justify-center p-4"},E={class:"max-w-2xl w-full"},G={key:0,class:"text-center"},X={class:"bg-gray-900 rounded-xl p-6 mb-6 border border-green-500/30"},q={class:"flex items-center justify-between mb-4"},Q={class:"text-white font-bold"},F={class:"flex items-center justify-between mb-4"},W={class:"text-green-400 font-bold"},J={class:"flex items-center justify-between"},O={class:"text-white font-bold"},Y={class:"flex gap-3"},Z={key:1,class:"text-center"},tt={class:"mb-6"},et={class:"text-sm text-gray-500"},st={class:"bg-gray-900 rounded-xl p-6 mb-6 border border-gray-800"},nt={class:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4 mb-4"},lt={class:"space-y-2 text-sm text-gray-300"},ot={class:"flex items-start gap-2"},at={class:"font-mono text-yellow-400"},rt={class:"flex items-start gap-3 mb-4"},it={class:"flex-1"},dt={class:"flex items-center gap-2 text-sm"},ut={class:"flex-1 bg-gray-800 rounded-full h-2 overflow-hidden"},ct={class:"text-gray-400 text-xs"},gt={class:"border-t border-gray-800 pt-4"},pt={class:"flex items-center justify-between text-sm mb-1"},ht={class:"text-white font-mono"},mt={class:"flex items-center justify-between text-sm"},vt={class:"text-yellow-400 font-bold"},xt={class:"flex gap-3"},bt=["disabled"],ft={key:2,class:"text-center"},yt={class:"mb-6"},wt={class:"text-gray-400 mb-6"},kt={class:"flex gap-3"},B=1e4,_t=3e5,It={__name:"PaymentProcessing",setup(Ct){const M=H(),d=A(),x=$(),w=S(),u=i(M.query.order_code||""),a=i("pending"),c=i(null),g=i(!1),b=i(""),z=i(Date.now()),f=i(300),V=N(()=>{const r=Date.now()-z.value;return Math.min(100,r/_t*100)});let l=null,o=null;const k=r=>new Intl.NumberFormat("vi-VN").format(r),y=async()=>{if(!u.value){b.value="KhÃ´ng tÃ¬m tháº¥y mÃ£ Ä‘Æ¡n hÃ ng",a.value="failed";return}g.value=!0;try{const s=await(await fetch(`https://hthree-film-production.up.railway.app/api/check_order_status.php?order_code=${u.value}`)).json();if(s.success)c.value=s.order,s.order.status==="completed"&&s.order.payment_status==="paid"?(a.value="completed",x.success("ğŸ‰ Thanh toÃ¡n thÃ nh cÃ´ng! GÃ³i cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t."),w.user&&await w.refreshUserData(),l&&clearInterval(l),o&&clearInterval(o)):s.order.payment_status==="failed"&&(a.value="failed",b.value=s.order.payment_note||"Thanh toÃ¡n tháº¥t báº¡i",l&&clearInterval(l),o&&clearInterval(o));else throw new Error(s.message||"KhÃ´ng thá»ƒ kiá»ƒm tra tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng")}catch(r){console.error("Error checking payment status:",r)}finally{g.value=!1}};return P(()=>{if(!u.value){x.error("KhÃ´ng tÃ¬m tháº¥y mÃ£ Ä‘Æ¡n hÃ ng"),d.push("/pricing");return}y(),l=setInterval(()=>{y()},B),o=setInterval(()=>{f.value--,f.value<=0&&(clearInterval(l),clearInterval(o),a.value==="pending"&&x.warning("Háº¿t thá»i gian chá». Vui lÃ²ng kiá»ƒm tra láº¡i trong trang tÃ i khoáº£n."))},1e3)}),R(()=>{l&&clearInterval(l),o&&clearInterval(o)}),(r,e)=>{var s,_,C,j;return m(),p("div",U,[t("div",E,[a.value==="completed"?(m(),p("div",G,[e[8]||(e[8]=I('<div class="mb-6"><div class="w-24 h-24 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce"><svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg></div><h1 class="text-3xl font-bold text-white mb-2">ğŸ‰ Thanh toÃ¡n thÃ nh cÃ´ng!</h1><p class="text-gray-400 mb-6">GÃ³i cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t</p></div>',1)),t("div",X,[t("div",q,[e[5]||(e[5]=t("span",{class:"text-gray-400"},"GÃ³i Ä‘Ã£ mua:",-1)),t("span",Q,n((s=c.value)==null?void 0:s.plan_name),1)]),t("div",F,[e[6]||(e[6]=t("span",{class:"text-gray-400"},"Sá»‘ tiá»n:",-1)),t("span",W,n(k((_=c.value)==null?void 0:_.total))+"Ä‘",1)]),t("div",J,[e[7]||(e[7]=t("span",{class:"text-gray-400"},"Thá»i háº¡n:",-1)),t("span",O,n((C=c.value)==null?void 0:C.duration)+" ngÃ y",1)])]),t("div",Y,[t("button",{onClick:e[0]||(e[0]=v=>h(d).push("/account")),class:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-3 px-6 rounded-lg transition-all"}," Xem gÃ³i cá»§a tÃ´i "),t("button",{onClick:e[1]||(e[1]=v=>h(d).push("/home")),class:"flex-1 bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-all"}," Xem phim ngay ")])])):a.value==="pending"?(m(),p("div",Z,[t("div",tt,[e[9]||(e[9]=I('<div class="w-24 h-24 bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-12 h-12 text-yellow-400 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><h1 class="text-3xl font-bold text-white mb-2">Äang xá»­ lÃ½ thanh toÃ¡n...</h1><p class="text-gray-400 mb-2">Vui lÃ²ng Ä‘á»£i trong giÃ¢y lÃ¡t</p>',3)),t("p",et,"Tá»± Ä‘á»™ng kiá»ƒm tra má»—i "+n(B/1e3)+"s",1)]),t("div",st,[t("div",nt,[e[15]||(e[15]=t("h3",{class:"text-blue-400 font-bold mb-3 flex items-center gap-2"},[t("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})]),T(" HÆ°á»›ng dáº«n chuyá»ƒn khoáº£n ")],-1)),t("div",lt,[e[12]||(e[12]=t("div",{class:"flex items-start gap-2"},[t("span",{class:"text-blue-400 font-bold"},"ğŸ“± BÆ°á»›c 1:"),t("span",null,"Má»Ÿ app ngÃ¢n hÃ ng cá»§a báº¡n")],-1)),e[13]||(e[13]=t("div",{class:"flex items-start gap-2"},[t("span",{class:"text-blue-400 font-bold"},"ğŸ“¸ BÆ°á»›c 2:"),t("span",null,"QuÃ©t mÃ£ QR Ä‘Ã£ hiá»ƒn thá»‹")],-1)),t("div",ot,[e[11]||(e[11]=t("span",{class:"text-blue-400 font-bold"},"âœï¸ BÆ°á»›c 3:",-1)),t("span",null,[e[10]||(e[10]=T("Nháº­p Ä‘Ãºng ná»™i dung: ")),t("span",at,n(u.value),1)])]),e[14]||(e[14]=t("div",{class:"flex items-start gap-2"},[t("span",{class:"text-blue-400 font-bold"},"âœ… BÆ°á»›c 4:"),t("span",null,"XÃ¡c nháº­n chuyá»ƒn khoáº£n")],-1))])]),t("div",rt,[e[18]||(e[18]=t("svg",{class:"w-6 h-6 text-blue-400 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),t("div",it,[e[16]||(e[16]=t("h3",{class:"text-white font-bold mb-2"},"ÄÃ£ chuyá»ƒn khoáº£n?",-1)),e[17]||(e[17]=t("p",{class:"text-gray-400 text-sm mb-3"}," Há»‡ thá»‘ng Ä‘ang tá»± Ä‘á»™ng kiá»ƒm tra giao dá»‹ch cá»§a báº¡n. ThÆ°á»ng máº¥t 10-30 giÃ¢y. ",-1)),t("div",dt,[t("div",ut,[t("div",{class:"bg-yellow-400 h-full transition-all duration-1000",style:K({width:V.value+"%"})},null,4)]),t("span",ct,n(f.value)+"s",1)])])]),t("div",gt,[e[21]||(e[21]=t("p",{class:"text-gray-400 text-sm mb-2"},"ThÃ´ng tin Ä‘Æ¡n hÃ ng:",-1)),t("div",pt,[e[19]||(e[19]=t("span",{class:"text-gray-500"},"MÃ£ Ä‘Æ¡n:",-1)),t("span",ht,n(u.value),1)]),t("div",mt,[e[20]||(e[20]=t("span",{class:"text-gray-500"},"Sá»‘ tiá»n:",-1)),t("span",vt,n(k((j=c.value)==null?void 0:j.total))+"Ä‘",1)])])]),t("div",xt,[t("button",{onClick:y,disabled:g.value,class:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-3 px-6 rounded-lg transition-all disabled:opacity-50 flex items-center justify-center gap-2"},[(m(),p("svg",{class:L(["w-5 h-5",{"animate-spin":g.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[22]||(e[22]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),t("span",null,n(g.value?"Äang kiá»ƒm tra...":"Kiá»ƒm tra ngay"),1)],8,bt),t("button",{onClick:e[2]||(e[2]=v=>h(d).push("/account")),class:"flex-1 bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-all"}," Vá» trang tÃ i khoáº£n ")])])):a.value==="failed"?(m(),p("div",ft,[t("div",yt,[e[23]||(e[23]=t("div",{class:"w-24 h-24 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-4"},[t("svg",{class:"w-12 h-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M6 18L18 6M6 6l12 12"})])],-1)),e[24]||(e[24]=t("h1",{class:"text-3xl font-bold text-white mb-2"},"Thanh toÃ¡n tháº¥t báº¡i",-1)),t("p",wt,n(b.value||"CÃ³ lá»—i xáº£y ra trong quÃ¡ trÃ¬nh xá»­ lÃ½"),1)]),e[25]||(e[25]=t("div",{class:"bg-red-500/10 border border-red-500/30 rounded-xl p-6 mb-6"},[t("p",{class:"text-red-400 text-sm"}," Náº¿u báº¡n Ä‘Ã£ chuyá»ƒn khoáº£n, vui lÃ²ng liÃªn há»‡ support Ä‘á»ƒ Ä‘Æ°á»£c há»— trá»£. ")],-1)),t("div",kt,[t("button",{onClick:e[3]||(e[3]=v=>h(d).push("/pricing")),class:"flex-1 bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-3 px-6 rounded-lg transition-all"}," Thá»­ láº¡i "),t("button",{onClick:e[4]||(e[4]=v=>h(d).push("/account")),class:"flex-1 bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-all"}," Vá» trang tÃ i khoáº£n ")])])):D("",!0)])])}}};export{It as default};
