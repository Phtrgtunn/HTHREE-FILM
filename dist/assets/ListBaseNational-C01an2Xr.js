import{_ as le,i as oe,r as p,u as ae,j as M,k as re,w as U,c as r,a as o,l as B,m as S,e as A,p as se,t as v,b as z,F as m,f as _,d as C,q as V,n as x,s as T,T as F,x as X,y as G,g as ne,o as a}from"./index-dFMl2Q0B.js";import{getMovieList as ie,mapMovieData as ue}from"./movieApi-Byp-7CmG.js";import{M as de}from"./MovieCardRecommended-D4sX9aGI.js";import{u as ce,a as ve,R as ge}from"./country-Dp9l4HL8.js";import"./useErrorHandler-svuVN1QS.js";const ye={class:"min-h-screen bg-black text-white"},pe={class:"relative bg-gradient-to-b from-gray-900 to-black pt-20 pb-12 px-4"},he={class:"max-w-7xl mx-auto"},me={class:"flex items-center gap-2 text-sm mb-6 animate-fade-in"},xe={class:"text-yellow-400 font-medium"},be={class:"text-4xl md:text-5xl font-bold mb-4 animate-slide-up"},we={class:"bg-gradient-to-r from-yellow-400 to-yellow-600 bg-clip-text text-transparent"},fe={class:"max-w-7xl mx-auto px-4 py-8"},ke={key:0,class:"space-y-8"},_e={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},Ce={key:1,class:"text-center py-20 animate-fade-in"},Me={class:"text-gray-400"},$e={class:"bg-gray-900/50 backdrop-blur-sm rounded-xl p-6 mb-8 border border-gray-800 animate-fade-in",style:{overflow:"visible"}},je={class:"flex flex-wrap gap-4",style:{overflow:"visible"}},Be={style:{position:"relative"}},Se={class:"truncate"},Ae={key:0,class:"absolute left-0 w-full min-w-[220px] bg-gray-800 border-2 border-yellow-400 rounded-lg shadow-2xl max-h-[300px] overflow-y-auto scrollbar-thin scrollbar-thumb-yellow-500 scrollbar-track-gray-700",style:{"z-index":"99999",top:"calc(100% + 8px)",position:"absolute !important","box-shadow":"0 25px 50px -12px rgba(0, 0, 0, 0.8)"}},Te=["onClick"],Re={style:{position:"relative"}},qe={class:"truncate"},Le={key:0,class:"absolute left-0 w-full min-w-[220px] bg-gray-800 border-2 border-yellow-400 rounded-lg shadow-2xl max-h-[300px] overflow-y-auto scrollbar-thin scrollbar-thumb-yellow-500 scrollbar-track-gray-700",style:{"z-index":"99999",top:"calc(100% + 8px)",position:"absolute !important","box-shadow":"0 25px 50px -12px rgba(0, 0, 0, 0.8)"}},Pe=["onClick"],Ee={style:{position:"relative"}},Ne={class:"truncate"},De={key:0,class:"absolute top-full left-0 mt-2 w-full min-w-[180px] bg-gray-800 border border-gray-700 rounded-lg shadow-2xl shadow-black/50 max-h-[300px] overflow-y-auto scrollbar-thin scrollbar-thumb-yellow-500 scrollbar-track-gray-700",style:{"z-index":"9999"}},ze=["onClick"],Ve={class:"mt-4 pt-4 border-t border-gray-800"},Fe={class:"text-sm text-gray-400"},Ie={class:"text-yellow-400 font-semibold"},Ye={key:0},Oe={class:"flex flex-col lg:flex-row gap-8"},Ke={class:"flex-1"},He={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},Ue={key:1,class:"text-center py-20 animate-fade-in"},Xe={class:"lg:w-80 flex-shrink-0"},Ge={class:"bg-gray-900/50 backdrop-blur-sm rounded-xl p-6 border border-gray-800 sticky top-24 animate-fade-in"},Qe={key:0,class:"space-y-3 max-h-[600px] overflow-y-auto scrollbar-thin scrollbar-thumb-yellow-500 scrollbar-track-gray-800"},Je={key:1,class:"text-gray-500 text-center py-8"},We={key:0,class:"flex justify-center mt-12 animate-fade-in"},Ze={class:"inline-flex items-center gap-2 bg-gray-900/50 backdrop-blur-sm rounded-xl p-2 border border-gray-800"},et=["disabled"],tt={key:0,class:"px-3 text-gray-600"},lt=["onClick"],ot=["disabled"],at=20,rt={__name:"ListBaseNational",setup(st){const k=ae(),R=ne(),$=ce(),b=oe(),w=ve(),f=p([]),g=p(1),q=p(!0),j=p(null),h=p(k.params.countrySlug),y=p(parseInt(k.params.pageNumber)||1),c=p(k.query.country||""),u=p(k.query.category||""),d=p(k.query.year||""),i=p(null),I=M(()=>{const t=[];if(u.value){const n=b.getAllCategories.find(l=>l.slug===u.value);n&&t.push(n.name)}const e=c.value||h.value;if(e){const n=w.getAllCountries.find(l=>l.slug===e);n&&t.push(n.name)}return d.value&&t.push(`Năm ${d.value}`),t.length>0?t.join(" - "):"Danh Sách Phim"}),Q=M(()=>{const t=new Date().getFullYear(),e=[];for(let n=t;n>=t-20;n--)e.push(n);return e}),J=M(()=>{if(!u.value)return"Tất cả thể loại";const t=b.getAllCategories.find(e=>e.slug===u.value);return t?t.name:"Tất cả thể loại"}),W=M(()=>{if(!c.value)return"Tất cả quốc gia";const t=w.getAllCountries.find(e=>e.slug===c.value);return t?t.name:"Tất cả quốc gia"}),Z=M(()=>d.value?d.value:"Tất cả năm"),L=t=>{i.value=i.value===t?null:t},Y=t=>{u.value=t,i.value=null,P()},O=t=>{c.value=t,i.value=null,P()},K=t=>{d.value=t,i.value=null,P()},P=()=>{const t=h.value?`country/${encodeURIComponent(h.value)}`:"country",e={};u.value&&(e.category=u.value),c.value&&(e.country=c.value),d.value&&(e.year=d.value),R.push({path:`/${t}/page/1`,query:e})},ee=()=>{u.value="",c.value="",d.value="",i.value=null,R.push({path:`/${h.value?`country/${h.value}`:"country"}/page/1`,query:{}})},E=async()=>{var t;q.value=!0,j.value=null,f.value=[];try{const e={page:y.value,limit:at,sort_field:"modified.time",sort_type:"desc"},n=c.value||h.value;n&&(e.country=n),u.value&&(e.category=u.value),d.value&&(e.year=parseInt(d.value));const l=await ie(e);if(l.status&&l.data){f.value=(l.data.items||[]).map(ue);const s=(t=l.data.params)==null?void 0:t.pagination;s&&(g.value=s.totalPages||1)}else f.value=[],g.value=1}catch(e){console.error("Error fetching movies:",e),j.value="Không thể tải dữ liệu phim. Vui lòng thử lại sau.",f.value=[],g.value=1}finally{q.value=!1}},N=t=>{if(t>=1&&t<=g.value){const e=h.value?`country/${encodeURIComponent(h.value)}`:"country",n={};u.value&&(n.category=u.value),c.value&&(n.country=c.value),d.value&&(n.year=d.value),R.push({path:`/${e}/page/${t}`,query:n})}},te=()=>{const t=new Set,e=2;t.add(1),g.value>1&&t.add(g.value);for(let s=y.value-e;s<=y.value+e;s++)s>=1&&s<=g.value&&t.add(s);const n=Array.from(t).sort((s,H)=>s-H),l=[];for(let s=0;s<n.length;s++)l.push(n[s]),s<n.length-1&&n[s+1]-n[s]>1&&l.push("ellipsis");return l},D={mounted(t,e){t.clickOutsideEvent=n=>{t===n.target||t.contains(n.target)||e.value()},document.addEventListener("click",t.clickOutsideEvent)},unmounted(t){document.removeEventListener("click",t.clickOutsideEvent)}};return re(async()=>{$.getRecommended.length===0&&await $.getRecommendedMovies(),b.getAllCategories.length===0&&await b.getCategory(),w.getAllCountries.length===0&&await w.getCountry(),U(()=>k.params,t=>{h.value=t.countrySlug||"",y.value=parseInt(t.pageNumber)||1,b.getAllCategories.length>0&&w.getAllCountries.length>0&&E()},{immediate:!0}),U(()=>k.query,t=>{u.value=t.category||"",c.value=t.country||"",d.value=t.year||"",b.getAllCategories.length>0&&w.getAllCountries.length>0&&E()},{deep:!0}),b.getAllCategories.length>0&&w.getAllCountries.length>0&&E()}),(t,e)=>{const n=se("router-link");return a(),r("div",ye,[o("div",pe,[o("div",he,[o("nav",me,[B(n,{to:"/home",class:"text-gray-400 hover:text-yellow-400 transition-colors"},{default:S(()=>e[8]||(e[8]=[A(" Trang chủ ")])),_:1}),e[9]||(e[9]=o("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)),o("span",xe,v(I.value),1)]),o("h1",be,[o("span",we,v(I.value),1)]),e[10]||(e[10]=o("p",{class:"text-gray-400 text-lg animate-slide-up animation-delay-100"}," Khám phá bộ sưu tập phim đặc sắc ",-1))])]),o("div",fe,[q.value?(a(),r("div",ke,[e[12]||(e[12]=z('<div class="bg-gray-900/50 rounded-xl p-6 animate-pulse" data-v-1e6d5e2c><div class="flex flex-wrap gap-4" data-v-1e6d5e2c><div class="h-10 bg-gray-800 rounded-lg w-40" data-v-1e6d5e2c></div><div class="h-10 bg-gray-800 rounded-lg w-40" data-v-1e6d5e2c></div><div class="h-10 bg-gray-800 rounded-lg w-32" data-v-1e6d5e2c></div></div></div>',1)),o("div",_e,[(a(),r(m,null,_(10,l=>o("div",{key:l,class:"animate-pulse"},e[11]||(e[11]=[o("div",{class:"aspect-[2/3] bg-gray-800 rounded-lg mb-2"},null,-1),o("div",{class:"h-4 bg-gray-800 rounded w-3/4 mb-2"},null,-1),o("div",{class:"h-3 bg-gray-800 rounded w-1/2"},null,-1)]))),64))])])):j.value?(a(),r("div",Ce,[e[13]||(e[13]=o("div",{class:"inline-flex items-center justify-center w-20 h-20 bg-red-500/10 rounded-full mb-4"},[o("svg",{class:"w-10 h-10 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e[14]||(e[14]=o("h3",{class:"text-xl font-semibold text-red-400 mb-2"},"Có lỗi xảy ra",-1)),o("p",Me,v(j.value),1)])):(a(),r(m,{key:2},[o("div",$e,[o("div",je,[V((a(),r("div",Be,[o("button",{onClick:e[0]||(e[0]=l=>L("category")),class:"bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white hover:border-yellow-400 transition-all min-w-[180px] flex items-center justify-between group"},[o("span",Se,v(J.value),1),(a(),r("svg",{class:x(["w-4 h-4 ml-2 transition-transform duration-300 group-hover:text-yellow-400",{"rotate-180":i.value==="category"}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[15]||(e[15]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),B(F,{name:"dropdown"},{default:S(()=>[i.value==="category"?(a(),r("div",Ae,[o("button",{onClick:e[1]||(e[1]=l=>Y("")),class:"w-full text-left px-4 py-2.5 hover:bg-yellow-400/10 hover:text-yellow-400 transition-colors text-white border-b border-gray-700"}," Tất cả thể loại "),(a(!0),r(m,null,_(T(b).getAllCategories,l=>(a(),r("button",{key:l.slug,onClick:s=>Y(l.slug),class:x(["w-full text-left px-4 py-2.5 hover:bg-yellow-400/10 hover:text-yellow-400 transition-colors text-white",{"bg-yellow-400/20 text-yellow-400":u.value===l.slug}])},v(l.name),11,Te))),128))])):C("",!0)]),_:1})])),[[D,()=>i.value!=="category"||(i.value=null)]]),V((a(),r("div",Re,[o("button",{onClick:e[2]||(e[2]=l=>L("country")),class:"bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white hover:border-yellow-400 transition-all min-w-[180px] flex items-center justify-between group"},[o("span",qe,v(W.value),1),(a(),r("svg",{class:x(["w-4 h-4 ml-2 transition-transform duration-300 group-hover:text-yellow-400",{"rotate-180":i.value==="country"}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[16]||(e[16]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),B(F,{name:"dropdown"},{default:S(()=>[i.value==="country"?(a(),r("div",Le,[o("button",{onClick:e[3]||(e[3]=l=>O("")),class:"w-full text-left px-4 py-2.5 hover:bg-yellow-400/10 hover:text-yellow-400 transition-colors text-white border-b border-gray-700"}," Tất cả quốc gia "),(a(!0),r(m,null,_(T(w).getAllCountries,l=>(a(),r("button",{key:l.slug,onClick:s=>O(l.slug),class:x(["w-full text-left px-4 py-2.5 hover:bg-yellow-400/10 hover:text-yellow-400 transition-colors text-white",{"bg-yellow-400/20 text-yellow-400":c.value===l.slug}])},v(l.name),11,Pe))),128))])):C("",!0)]),_:1})])),[[D,()=>i.value!=="country"||(i.value=null)]]),V((a(),r("div",Ee,[o("button",{onClick:e[4]||(e[4]=l=>L("year")),class:"bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white hover:border-yellow-400 transition-all min-w-[140px] flex items-center justify-between group"},[o("span",Ne,v(Z.value),1),(a(),r("svg",{class:x(["w-4 h-4 ml-2 transition-transform duration-300 group-hover:text-yellow-400",{"rotate-180":i.value==="year"}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[17]||(e[17]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))]),B(F,{name:"dropdown"},{default:S(()=>[i.value==="year"?(a(),r("div",De,[o("button",{onClick:e[5]||(e[5]=l=>K("")),class:"w-full text-left px-4 py-2.5 hover:bg-yellow-400/10 hover:text-yellow-400 transition-colors text-white border-b border-gray-700"}," Tất cả năm "),(a(!0),r(m,null,_(Q.value,l=>(a(),r("button",{key:l,onClick:s=>K(l),class:x(["w-full text-left px-4 py-2.5 hover:bg-yellow-400/10 hover:text-yellow-400 transition-colors text-white",{"bg-yellow-400/20 text-yellow-400":d.value===l}])},v(l),11,ze))),128))])):C("",!0)]),_:1})])),[[D,()=>i.value!=="year"||(i.value=null)]]),u.value||c.value||d.value?(a(),r("button",{key:0,onClick:ee,class:"bg-gray-800 hover:bg-yellow-400/10 border border-gray-700 hover:border-yellow-400 rounded-lg px-4 py-2.5 text-gray-300 hover:text-yellow-400 transition-all flex items-center gap-2 group"},e[18]||(e[18]=[o("svg",{class:"w-4 h-4 transition-transform group-hover:rotate-90",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),A(" Xóa bộ lọc ")]))):C("",!0)]),o("div",Ve,[o("p",Fe,[e[19]||(e[19]=A(" Tìm thấy ")),o("span",Ie,v(f.value.length),1),e[20]||(e[20]=A(" phim ")),g.value>1?(a(),r("span",Ye," - Trang "+v(y.value)+"/"+v(g.value),1)):C("",!0)])])]),o("div",Oe,[o("div",Ke,[f.value&&f.value.length>0?(a(),r("div",He,[(a(!0),r(m,null,_(f.value,(l,s)=>(a(),X(de,{key:l.slug||l.id||s,movie:l,trending:!1,class:"animate-fade-in-up",style:G({animationDelay:`${s*50}ms`})},null,8,["movie","style"]))),128))])):(a(),r("div",Ue,e[21]||(e[21]=[z('<div class="inline-flex items-center justify-center w-20 h-20 bg-gray-800 rounded-full mb-4" data-v-1e6d5e2c><svg class="w-10 h-10 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-1e6d5e2c><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" data-v-1e6d5e2c></path></svg></div><h3 class="text-xl font-semibold text-gray-400 mb-2" data-v-1e6d5e2c>Không tìm thấy phim</h3><p class="text-gray-500" data-v-1e6d5e2c>Thử thay đổi bộ lọc để xem thêm phim</p>',3)])))]),o("aside",Xe,[o("div",Ge,[e[22]||(e[22]=z('<div class="flex items-center gap-2 mb-6" data-v-1e6d5e2c><div class="w-8 h-8 bg-yellow-400/10 rounded-lg flex items-center justify-center" data-v-1e6d5e2c><svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20" data-v-1e6d5e2c><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" data-v-1e6d5e2c></path></svg></div><h3 class="text-lg font-bold text-white" data-v-1e6d5e2c>Bảng Xếp Hạng</h3></div>',1)),T($).getRecommended.length>0?(a(),r("div",Qe,[(a(!0),r(m,null,_(T($).getRecommended.slice(0,10),(l,s)=>(a(),X(ge,{key:l.slug||l.id||s,trendingMovie:l,index:s,class:"animate-fade-in",style:G({animationDelay:`${s*100}ms`})},null,8,["trendingMovie","index","style"]))),128))])):(a(),r("p",Je,"Đang tải..."))])])]),g.value>1?(a(),r("div",We,[o("nav",Ze,[o("button",{onClick:e[6]||(e[6]=l=>N(y.value-1)),disabled:y.value===1,class:x(["p-2 rounded-lg transition-all",y.value===1?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-yellow-400 hover:bg-gray-800"])},e[23]||(e[23]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)]),10,et),(a(!0),r(m,null,_(te(),(l,s)=>(a(),r(m,{key:s},[l==="ellipsis"?(a(),r("span",tt,"...")):(a(),r("button",{key:1,onClick:H=>N(l),class:x(["min-w-[40px] h-10 rounded-lg font-medium transition-all",y.value===l?"bg-yellow-400 text-black shadow-lg shadow-yellow-400/50":"text-gray-400 hover:text-white hover:bg-gray-800"])},v(l),11,lt))],64))),128)),o("button",{onClick:e[7]||(e[7]=l=>N(y.value+1)),disabled:y.value===g.value,class:x(["p-2 rounded-lg transition-all",y.value===g.value?"text-gray-600 cursor-not-allowed":"text-gray-400 hover:text-yellow-400 hover:bg-gray-800"])},e[24]||(e[24]=[o("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),10,ot)])])):C("",!0)],64))])])}}},vt=le(rt,[["__scopeId","data-v-1e6d5e2c"]]);export{vt as default};
