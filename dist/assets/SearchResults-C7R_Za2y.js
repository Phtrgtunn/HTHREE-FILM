import{_ as j,r as h,w as S,c as n,a as e,d as g,e as B,t as u,b as R,F as w,f as b,x as V,m as $,p as E,n as k,g as I,u as M,o as r}from"./index-BdBw76LB.js";import{searchMovies as N,mapMovieData as z}from"./movieApi-_lm77jzM.js";const K={class:"min-h-screen bg-gradient-to-b from-gray-900 to-gray-800 text-white py-8"},T={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},A={class:"mb-8"},F={class:"text-3xl font-bold mb-2"},D={class:"text-yellow-400"},W={key:0,class:"text-gray-400"},G={key:0,class:"flex justify-center items-center h-96"},H={key:1,class:"text-center text-red-400 text-lg py-12"},L={class:"text-xl font-semibold"},J={key:2,class:"text-center py-12"},O={class:"text-xl text-gray-400"},Q={key:3},U={class:"space-y-4 mb-8"},X={class:"flex-shrink-0 w-32 sm:w-40 md:w-48"},Y=["src","alt"],Z={class:"flex-1 py-3 pr-4 min-w-0"},tt={class:"text-lg font-bold text-white group-hover:text-yellow-400 transition-colors truncate"},et={class:"text-sm text-gray-400 truncate mb-2"},st={class:"flex flex-wrap gap-2 text-xs mb-2"},at={key:0,class:"bg-blue-500 text-white px-2 py-1 rounded font-medium"},ot={key:1,class:"bg-yellow-500 text-black px-2 py-1 rounded font-semibold"},lt={key:2,class:"bg-purple-500 text-white px-2 py-1 rounded font-medium"},rt={key:3,class:"bg-green-500 text-white px-2 py-1 rounded font-medium"},nt={key:0,class:"text-sm text-gray-300 line-clamp-2 hidden sm:block"},it={key:0,class:"flex justify-center mt-10"},ct={role:"navigation","aria-label":"pagination",class:"mx-auto flex w-full justify-center"},ut={class:"flex flex-row items-center gap-2"},dt=["disabled"],pt={key:0,class:"flex size-9 items-center justify-center text-gray-400"},ht=["onClick","aria-label"],gt=["disabled"],vt=20,xt={__name:"SearchResults",setup(mt){const f=M(),C=I(),v=h(""),d=h([]),m=h(!1),x=h(null),i=h(1),p=h(1),y=h(0),q=async()=>{var s;let a=f.query.q;if(!a||!a.trim()){d.value=[],x.value="Vui l√≤ng nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm";return}a=a.trim().replace(/\s+/g," "),v.value=a,m.value=!0,x.value=null,console.log("üîç Searching for:",a,"Page:",i.value);try{const l=await N(a,{page:i.value,limit:vt});if(console.log("üîç Search response:",l),console.log("üîç Response status:",l.status),console.log("üîç Response data:",l.data),(l.status==="success"||l.status===!0)&&l.data){d.value=(l.data.items||[]).map(o=>{const c=z(o);return c.poster_path&&!c.poster_path.startsWith("http")&&(c.poster_path=`https://phimimg.com/${c.poster_path}`),c.backdrop_path&&!c.backdrop_path.startsWith("http")&&(c.backdrop_path=`https://phimimg.com/${c.backdrop_path}`),c});const t=(s=l.data.params)==null?void 0:s.pagination;t?(p.value=t.totalPages||1,y.value=t.totalItems||d.value.length):(p.value=1,y.value=d.value.length),console.log("‚úÖ Found:",d.value.length,"movies"),console.log("‚úÖ Movies:",d.value)}else console.warn("‚ùå Kh√¥ng parse ƒë∆∞·ª£c response"),console.warn("Response:",l),d.value=[],p.value=1,y.value=0}catch(l){console.error("‚ùå Search error:",l),x.value="Kh√¥ng th·ªÉ t√¨m ki·∫øm. Vui l√≤ng th·ª≠ l·∫°i sau.",d.value=[]}finally{m.value=!1}},_=a=>{a>=1&&a<=p.value&&(i.value=a,C.push({path:"/search",query:{q:v.value,page:a}}))},P=()=>{const a=new Set,s=2;a.add(1),p.value>1&&a.add(p.value);for(let o=i.value-s;o<=i.value+s;o++)o>=1&&o<=p.value&&a.add(o);let l=Array.from(a).sort((o,c)=>o-c),t=[];for(let o=0;o<l.length;o++)t.push(l[o]),o<l.length-1&&l[o+1]-l[o]>1&&t.push("ellipsis");return t};return S(()=>[f.query.q,f.query.page],([a,s])=>{v.value=a||"",i.value=parseInt(s)||1,q()},{immediate:!0}),(a,s)=>{const l=E("router-link");return r(),n("div",K,[e("div",T,[e("div",A,[e("h1",F,[s[3]||(s[3]=B(" K·∫øt qu·∫£ t√¨m ki·∫øm: ")),e("span",D,u(v.value),1)]),!m.value&&d.value.length>0?(r(),n("p",W," T√¨m th·∫•y "+u(y.value)+" k·∫øt qu·∫£ ",1)):g("",!0)]),m.value?(r(),n("div",G,s[4]||(s[4]=[R('<div class="text-center" data-v-20712c04><svg class="animate-spin h-12 w-12 text-yellow-400 mx-auto mb-4" fill="none" viewBox="0 0 24 24" data-v-20712c04><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" class="opacity-25" data-v-20712c04></circle><path fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" class="opacity-75" data-v-20712c04></path></svg><p class="text-xl font-semibold text-gray-300" data-v-20712c04>ƒêang t√¨m ki·∫øm...</p></div>',1)]))):x.value?(r(),n("div",H,[e("p",L,u(x.value),1)])):d.value.length===0?(r(),n("div",J,[s[5]||(s[5]=e("svg",{class:"w-24 h-24 mx-auto mb-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),e("p",O,'Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o cho "'+u(v.value)+'"',1),s[6]||(s[6]=e("p",{class:"text-gray-500 mt-2"},"Th·ª≠ t√¨m ki·∫øm v·ªõi t·ª´ kh√≥a kh√°c",-1))])):(r(),n("div",Q,[e("div",U,[(r(!0),n(w,null,b(d.value,(t,o)=>(r(),V(l,{key:t.slug||t.id||o,to:`/film/${t.slug}`,class:"flex gap-4 bg-gray-800 rounded-lg overflow-hidden hover:bg-gray-750 transition-colors group"},{default:$(()=>[e("div",X,[e("img",{src:t.backdrop_path||t.poster_path||"https://placehold.co/300x169/1a1a1a/fff?text=No+Image",alt:t.title,class:"w-full h-full object-cover aspect-video",onError:s[0]||(s[0]=c=>c.target.src="https://placehold.co/300x169/1a1a1a/fff?text=Error")},null,40,Y)]),e("div",Z,[e("h3",tt,u(t.title),1),e("p",et,u(t.original_title),1),e("div",st,[t.year?(r(),n("span",at,u(t.year),1)):g("",!0),t.quality?(r(),n("span",ot,u(t.quality),1)):g("",!0),t.lang?(r(),n("span",lt,u(t.lang),1)):g("",!0),t.episode_current?(r(),n("span",rt,u(t.episode_current),1)):g("",!0)]),t.overview?(r(),n("p",nt,u(t.overview),1)):g("",!0)])]),_:2},1032,["to"]))),128))]),p.value>1?(r(),n("div",it,[e("nav",ct,[e("ul",ut,[e("li",null,[e("button",{onClick:s[1]||(s[1]=t=>_(i.value-1)),disabled:i.value===1,class:k([{"opacity-50 pointer-events-none":i.value===1},"px-3 py-1.5 rounded-full text-sm font-medium transition-all hover:bg-gray-700"]),"aria-label":"Previous page"},s[7]||(s[7]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"m15 18-6-6 6-6"})],-1)]),10,dt)]),(r(!0),n(w,null,b(P(),(t,o)=>(r(),n("li",{key:o},[t==="ellipsis"?(r(),n("span",pt,s[8]||(s[8]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("circle",{cx:"12",cy:"12",r:"1"}),e("circle",{cx:"19",cy:"12",r:"1"}),e("circle",{cx:"5",cy:"12",r:"1"})],-1)]))):(r(),n("button",{key:1,onClick:c=>_(t),class:k([{"bg-yellow-400 text-black":i.value===t,"hover:bg-gray-700":i.value!==t},"inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium transition-all h-9 px-4 py-1"]),"aria-label":`Page ${t}`},u(t),11,ht))]))),128)),e("li",null,[e("button",{onClick:s[2]||(s[2]=t=>_(i.value+1)),disabled:i.value===p.value,class:k([{"opacity-50 pointer-events-none":i.value===p.value},"px-3 py-1.5 rounded-full text-sm font-medium transition-all hover:bg-gray-700"]),"aria-label":"Next page"},s[9]||(s[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"m9 18 6-6-6-6"})],-1)]),10,gt)])])])])):g("",!0)]))])])}}},_t=j(xt,[["__scopeId","data-v-20712c04"]]);export{_t as default};
